{% extends "layouts/base.njk" %}

{% block content %}
<main id="main" class="post">
  <header>
    <h1>{{ title }}</h1>
    {% from "macros/macro.njk" import meta %}
      {{ meta({
        author: author,
        date: page.date,
        layout: layout,
        content: content
      }) }}
      {% include "partials/first-published.html" %}
  </header>
    {% include "partials/toc.html" %}
    {% include "partials/editors-note.njk" %}
    {{ content | safe }}
    {% if tags %}
    <div class="post-tag font-weight:500">
      Tagged: 
        {% for tag in tags | filterTagList %}
          {% set tagUrl %}/tags/{{ tag | slug }}/{% endset %}
          <a href="{{ tagUrl | url }}" class="post-tag-item">{{ tag }}</a>
        {% endfor %}
    </div>
    {% endif %}
    <div class="social-link">
      <span aria-hidden="true">Share:</span>{% include "partials/twitter-share.html" %}
    </div>
</main>
<aside class="additional-posts">
  {% set asideHeading %}Related Posts{% endset %}
  {% set postslist = collections.posts | getByTags(tags) | randomLimit(2, page.url) %}
  {% set postsListLength = postslist | length %}
  {% if postsListLength == 0 %}
    {% set asideHeading %}More Posts{% endset %}
    {% set postslist = collections.posts | randomLimit(2, page.url) %}
  {% endif %}
  {% set headingLevel = 'h3' %}

  <h2>{{ asideHeading }}</h2>
  {% include "partials/postslist.njk" %}
  {% include "partials/view-all.html" %}
</aside>
{% endblock %}