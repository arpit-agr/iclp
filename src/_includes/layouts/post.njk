---
layout: layouts/base
---
<main id="main" class="post">
    <h1>{{ title | addNbsp | safe }}</h1>
    {% from "macros/macro.njk" import meta %}
      {{ meta({
        author: author,
        date: page.date,
        layout: layout,
        content: content,
        tags: tags
      }) }}
    {% include "partials/toc.html" %}
    {{ content | safe}}
</main>
<hr style="border-style: solid;">
<aside class="post-list">
  <h2>Recent Articles</h2>
  {% set previousPost = collections.posts | getPreviousCollectionItem(page) %}
  {% set nextPost = collections.posts | getNextCollectionItem(page) %}
  
  {% if previousPost %}
    <article class="postlist-item">
      <h3>
        <a href="{{ previousPost.url }}" class="postlist-link">{% if previousPost.data.title %}{{ previousPost.data.title }}{% else %}<code>{{ previousPost.url }}</code>{% endif %}</a>
      </h3>
      {{ meta({
        author: author,
        date: page.date,
        tags: tags
      }) }}
    </article>
  {% endif %}
  {% if nextPost %}
    <hr>
    <article class="postlist-item{% if post.url == url %} postlist-item-active{% endif %}">
      <h3>
        <a href="{{ nextPost.url }}" class="postlist-link">{% if nextPost.data.title %}{{ nextPost.data.title }}{% else %}<code>{{ nextPost.url }}</code>{% endif %}</a>
      </h3>
      {{ meta({
        author: author,
        date: page.date,
        tags: tags
      }) }}
    </article>
  {% endif %}
</aside>
<hr style="border-style: solid;">
<aside class="post-list">
  <h2>Related Posts</h2>
    {% set pickedPosts %}
      {{ tags }}
    {% endset %}
    {% for post in collections.posts | pluck(pickedPosts, 'tags') | reverse | limit(3) %}
      {% if post.url == page.url %}
      {% else %}
      <article class="postlist-item">
        <h3>
          <a href="{{ post.url }}" class="postlist-link">{{ post.data.title }}</a>
        </h3>
        {{ meta({
          author: post.data.author,
          date: post.date,
          tags: post.data.tags
        }) }}
        <hr>
      </article>
      {% endif %}
    {% endfor %}
</aside>